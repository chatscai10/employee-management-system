# Google Sheets 數據庫架構設計

## 工作表結構總覽

本系統使用一個 Google Spreadsheet 包含多個工作表，每個工作表對應不同的數據實體。

## 1. Employees (員工資料表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 員工編號 | TEXT | 自動生成，格式：EMP001 | EMP001 |
| B | 姓名 | TEXT | 員工全名 | 王小明 |
| C | 身分證號碼 | TEXT | 台灣身分證號 | A123456789 |
| D | 出生日期 | DATE | YYYY-MM-DD格式 | 1990-01-01 |
| E | 性別 | TEXT | 男/女 | 男 |
| F | 駕照類別 | TEXT | 多個類別用逗號分隔 | 普通重機,汽車 |
| G | 聯絡電話 | TEXT | 手機號碼 | 0912345678 |
| H | 居住地址 | TEXT | 完整地址 | 桃園市中壢區... |
| I | 入職日期 | DATE | 加入公司日期 | 2025-01-01 |
| J | 職位 | TEXT | 當前職位 | 店員 |
| K | 分店 | TEXT | 所屬分店 | 內壢店 |
| L | 薪資 | NUMBER | 月薪 | 30000 |
| M | 狀態 | TEXT | 在職/離職/停職 | 在職 |
| N | 權限等級 | TEXT | 員工/主管/管理員 | 員工 |
| O | 提交時間 | DATETIME | 註冊時間 | 2025-08-02 10:30:00 |
| P | 最後更新 | DATETIME | 資料更新時間 | 2025-08-02 15:20:00 |
| Q | 備註 | TEXT | 其他備註 | 表現優良 |

## 2. AttendanceLog (打卡記錄表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 記錄ID | TEXT | 自動生成 | ATT202508020001 |
| B | 員工編號 | TEXT | 對應員工表 | EMP001 |
| C | 員工姓名 | TEXT | 冗餘欄位，便於查詢 | 王小明 |
| D | 打卡時間 | DATETIME | 精確到秒 | 2025-08-02 09:00:15 |
| E | 打卡類型 | TEXT | 上班/下班 | 上班 |
| F | 分店名稱 | TEXT | 打卡地點 | 內壢店 |
| G | GPS座標 | TEXT | 緯度,經度 | 24.9748412,121.2556713 |
| H | 距離分店 | NUMBER | 距離(公尺) | 5.2 |
| I | 設備指紋 | TEXT | Base64編碼 | eyJ1c2VyQWdlbnQi... |
| J | IP位址 | TEXT | 來源IP | 192.168.1.100 |
| K | 狀態 | TEXT | 正常/遲到/異常 | 正常 |
| L | 遲到分鐘 | NUMBER | 遲到時間 | 0 |
| M | 異常原因 | TEXT | 異常說明 | GPS距離過遠 |
| N | 照片路徑 | TEXT | 打卡照片URL | https://drive.google.com/... |
| O | 提交時間 | DATETIME | 系統記錄時間 | 2025-08-02 09:00:16 |
| P | 備註 | TEXT | 其他說明 | 正常上班 |

## 3. RevenueLog (營收記錄表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 記錄ID | TEXT | 自動生成 | REV202508020001 |
| B | 員工編號 | TEXT | 提交者 | EMP001 |
| C | 員工姓名 | TEXT | 提交者姓名 | 王小明 |
| D | 營業日期 | DATE | 實際營業日 | 2025-08-02 |
| E | 分店名稱 | TEXT | 營業分店 | 內壢店 |
| F | 現場訂單數 | NUMBER | 現場訂單張數 | 25 |
| G | 現場訂單收入 | NUMBER | 現場收入 | 12500 |
| H | 外送訂單收入 | NUMBER | 外送收入 | 3500 |
| I | 其他收入 | NUMBER | 其他收入 | 500 |
| J | 收入總額 | NUMBER | 總收入 | 16500 |
| K | 材料成本 | NUMBER | 成本支出 | 5000 |
| L | 其他支出 | NUMBER | 其他支出 | 200 |
| M | 支出總額 | NUMBER | 總支出 | 5200 |
| N | 淨收入 | NUMBER | 收入-支出 | 11300 |
| O | 獎金類別 | TEXT | 平日獎金/假日獎金 | 平日獎金 |
| P | 計算獎金 | NUMBER | 自動計算 | 0 |
| Q | 訂單平均 | NUMBER | 平均客單價 | 500 |
| R | 提交時間 | DATETIME | 提交時間 | 2025-08-02 22:30:00 |
| S | 備註 | TEXT | 備註說明 | 生意不錯 |

## 4. OrderLog (叫貨記錄表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 記錄ID | TEXT | 自動生成 | ORD202508020001 |
| B | 員工編號 | TEXT | 叫貨人 | EMP001 |
| C | 員工姓名 | TEXT | 叫貨人姓名 | 王小明 |
| D | 叫貨日期 | DATE | 叫貨日期 | 2025-08-02 |
| E | 分店名稱 | TEXT | 叫貨分店 | 內壢店 |
| F | 品項清單 | TEXT | JSON格式儲存 | [{"name":"雞腿","qty":10}] |
| G | 總金額 | NUMBER | 叫貨總金額 | 3500 |
| H | 供應商 | TEXT | 供應商名稱 | ABC食材行 |
| I | 預計到貨日 | DATE | 預計到貨 | 2025-08-03 |
| J | 實際到貨日 | DATE | 實際到貨 | 2025-08-03 |
| K | 狀態 | TEXT | 已下單/已到貨/異常 | 已下單 |
| L | 異常標記 | TEXT | 異常原因 | 供應商缺貨 |
| M | 照片路徑 | TEXT | 相關照片 | https://drive.google.com/... |
| N | 提交時間 | DATETIME | 提交時間 | 2025-08-02 14:30:00 |
| O | 備註 | TEXT | 備註說明 | 急需補貨 |

## 5. Schedule_Staff (員工排班表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 記錄ID | TEXT | 自動生成 | SCH202508S001 |
| B | 員工編號 | TEXT | 排班員工 | EMP001 |
| C | 員工姓名 | TEXT | 員工姓名 | 王小明 |
| D | 排班月份 | TEXT | YYYY-MM格式 | 2025-08 |
| E | 分店名稱 | TEXT | 希望分店 | 內壢店 |
| F | 選擇日期 | TEXT | JSON格式 | ["2025-08-01","2025-08-02"] |
| G | 時段偏好 | TEXT | 早班/晚班/全天 | 早班 |
| H | 提交時間 | DATETIME | 提交時間 | 2025-08-01 10:00:00 |
| I | 狀態 | TEXT | 已提交/已確認 | 已提交 |

## 6. Schedule_Admin (管理員排班表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 記錄ID | TEXT | 自動生成 | SCH202508A001 |
| B | 排班月份 | TEXT | YYYY-MM格式 | 2025-08 |
| C | 分店名稱 | TEXT | 排班分店 | 內壢店 |
| D | 日期 | DATE | 排班日期 | 2025-08-02 |
| E | 班次時段 | TEXT | 早班/晚班 | 早班 |
| F | 員工編號 | TEXT | 排班員工 | EMP001 |
| G | 員工姓名 | TEXT | 員工姓名 | 王小明 |
| H | 是否休假 | BOOLEAN | TRUE/FALSE | FALSE |
| I | 休假原因 | TEXT | 休假原因 | 事假 |
| J | 建立時間 | DATETIME | 建立時間 | 2025-08-01 15:00:00 |
| K | 最後更新 | DATETIME | 更新時間 | 2025-08-01 15:00:00 |

## 7. PromotionVotes (升遷投票表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 投票ID | TEXT | 自動生成 | VOTE202508001 |
| B | 發起人編號 | TEXT | 申請升遷者 | EMP001 |
| C | 發起人姓名 | TEXT | 申請人姓名 | 王小明 |
| D | 目標職位 | TEXT | 申請職位 | 副店長 |
| E | 發起日期 | DATE | 發起日期 | 2025-08-02 |
| F | 投票截止日期 | DATE | 截止日期 | 2025-08-09 |
| G | 需要同意人數 | NUMBER | 需要同意票數 | 5 |
| H | 當前同意數 | NUMBER | 目前同意票 | 3 |
| I | 當前反對數 | NUMBER | 目前反對票 | 1 |
| J | 投票狀態 | TEXT | 進行中/成功/失敗 | 進行中 |
| K | 結束時間 | DATETIME | 投票結束時間 | 2025-08-09 23:59:59 |
| L | 備註 | TEXT | 投票說明 | 工作表現優異 |

## 8. VoteRecords (投票記錄表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 記錄ID | TEXT | 自動生成 | VR202508001 |
| B | 投票ID | TEXT | 對應投票 | VOTE202508001 |
| C | 投票人編號 | TEXT | 投票者 | EMP002 |
| D | 投票人姓名 | TEXT | 投票者姓名 | 李小華 |
| E | 投票選擇 | TEXT | 同意/反對 | 同意 |
| F | 投票時間 | DATETIME | 投票時間 | 2025-08-02 14:30:00 |
| G | 修改次數 | NUMBER | 當日修改次數 | 0 |
| H | 備註 | TEXT | 投票理由 | 認為適合 |

## 9. MaintenanceLog (維修記錄表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 記錄ID | TEXT | 自動生成 | MAIN202508001 |
| B | 員工編號 | TEXT | 報修人 | EMP001 |
| C | 員工姓名 | TEXT | 報修人姓名 | 王小明 |
| D | 報修日期 | DATE | 報修日期 | 2025-08-02 |
| E | 分店名稱 | TEXT | 報修分店 | 內壢店 |
| F | 設備名稱 | TEXT | 故障設備 | 冰箱 |
| G | 故障描述 | TEXT | 問題描述 | 不製冷 |
| H | 緊急程度 | TEXT | 低/中/高/緊急 | 高 |
| I | 維修狀態 | TEXT | 已報修/處理中/已完成 | 已報修 |
| J | 維修人員 | TEXT | 負責維修 | 張師傅 |
| K | 預計完成日 | DATE | 預計完成 | 2025-08-03 |
| L | 實際完成日 | DATE | 實際完成 | 2025-08-03 |
| M | 維修費用 | NUMBER | 維修成本 | 1500 |
| N | 照片路徑 | TEXT | 故障照片 | https://drive.google.com/... |
| O | 提交時間 | DATETIME | 報修時間 | 2025-08-02 10:30:00 |
| P | 備註 | TEXT | 其他說明 | 影響營業 |

## 10. SystemSettings (系統參數表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 參數類別 | TEXT | 參數分類 | 分店設定 |
| B | 參數名稱 | TEXT | 參數名 | stores |
| C | 參數值 | TEXT | JSON格式 | [{"name":"內壢店","lat":24.9748}] |
| D | 說明 | TEXT | 參數說明 | 所有分店的基本資訊 |
| E | 最後更新時間 | DATETIME | 更新時間 | 2025-08-02 10:00:00 |
| F | 更新人員 | TEXT | 更新者 | 系統管理員 |

## 11. Positions (職位階級設定表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 職位ID | TEXT | 職位代碼 | POS001 |
| B | 職位名稱 | TEXT | 職位名稱 | 副店長 |
| C | 職位階級 | NUMBER | 階級順序 | 3 |
| D | 薪資 | NUMBER | 基本薪資 | 45000 |
| E | 獎金比例 | NUMBER | 獎金倍數 | 1.2 |
| F | 總名額 | NUMBER | 職位總名額 | 5 |
| G | 任職需滿天數 | NUMBER | 升遷條件 | 180 |
| H | 失敗緩衝天數 | NUMBER | 失敗後等待期 | 90 |
| I | 升遷所需同意比例 | NUMBER | 同意比例 | 0.6 |
| J | 投票持續天數 | NUMBER | 投票期限 | 7 |
| K | 懲罰規則 | TEXT | JSON格式規則 | {"demote_days": 30} |
| L | 備註 | TEXT | 職位說明 | 分店副主管 |

## 12. ErrorLog (錯誤日誌表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 錯誤ID | TEXT | 自動生成 | ERR202508020001 |
| B | 發生時間 | DATETIME | 錯誤時間 | 2025-08-02 14:30:15 |
| C | 錯誤類型 | TEXT | 錯誤分類 | DATABASE_ERROR |
| D | 函式名稱 | TEXT | 出錯函式 | calculateBonus |
| E | 錯誤訊息 | TEXT | 錯誤內容 | TypeError: Cannot read... |
| F | 用戶ID | TEXT | 觸發用戶 | EMP001 |
| G | 用戶姓名 | TEXT | 用戶姓名 | 王小明 |
| H | 請求參數 | TEXT | JSON格式 | {"revenue": 15000} |
| I | 嚴重程度 | TEXT | LOW/MEDIUM/HIGH/CRITICAL | HIGH |
| J | 狀態 | TEXT | 未處理/處理中/已解決 | 未處理 |
| K | 處理人員 | TEXT | 負責處理 | 系統管理員 |
| L | 解決時間 | DATETIME | 解決時間 | 2025-08-02 15:00:00 |
| M | 解決方案 | TEXT | 處理方式 | 修復資料驗證邏輯 |

## 13. NotificationsLog (通知記錄表)

| 欄位 | 名稱 | 類型 | 說明 | 範例 |
|------|------|------|------|------|
| A | 通知ID | TEXT | 自動生成 | NOTIF202508001 |
| B | 通知類型 | TEXT | 通知分類 | ATTENDANCE |
| C | 發送對象 | TEXT | 接收群組 | BOSS_GROUP |
| D | 通知內容 | TEXT | 訊息內容 | 王小明 到 內壢店 上班了~ |
| E | 發送時間 | DATETIME | 發送時間 | 2025-08-02 09:00:20 |
| F | 發送狀態 | TEXT | 成功/失敗 | 成功 |
| G | Telegram訊息ID | TEXT | 訊息ID | 12345 |
| H | 錯誤訊息 | TEXT | 失敗原因 | API限制 |

## 數據關聯圖

```
Employees (主表)
    ├── AttendanceLog (1:N) - 員工編號
    ├── RevenueLog (1:N) - 員工編號  
    ├── OrderLog (1:N) - 員工編號
    ├── Schedule_Staff (1:N) - 員工編號
    ├── Schedule_Admin (1:N) - 員工編號
    ├── PromotionVotes (1:N) - 發起人編號
    ├── VoteRecords (1:N) - 投票人編號
    └── MaintenanceLog (1:N) - 員工編號

PromotionVotes
    └── VoteRecords (1:N) - 投票ID

SystemSettings (獨立表)
Positions (獨立表)
ErrorLog (獨立表)
NotificationsLog (獨立表)
```

## 索引建議

為提升查詢效能，建議對以下欄位建立索引：
- 所有表的主鍵欄位 (A欄)
- 員工編號欄位
- 日期相關欄位
- 狀態欄位

## 備份策略

1. **每日備份**: 自動備份到 Google Drive
2. **增量備份**: 只備份變更數據
3. **版本控制**: 保留最近30天的備份
4. **恢復測試**: 定期測試備份恢復功能