<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁÆ°ÁêÜÂì°Á≥ªÁµ± - ‰ºÅÊ•≠Âì°Â∑•ÁÆ°ÁêÜ</title>
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üë®‚Äçüíº</text></svg>">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Microsoft YaHei', Arial, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh;
            color: #333;
        }
        
        /* ÊâãÊ©üÁ´ØÂÑ™ÂÖàË®≠Ë®à */
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
        }
        
        /* È†ÇÈÉ®Â∞éËà™ */
        .admin-header {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
        }
        
        .admin-header h1 {
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 1.8em;
        }
        
        .admin-header p {
            color: #7f8c8d;
            font-size: 1em;
        }
        
        /* ÂäüËÉΩÈÅ∏ÂñÆ */
        .admin-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .menu-item {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: none;
            font-size: 14px;
        }
        
        .menu-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .menu-item.active {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        
        .menu-item i {
            font-size: 2em;
            margin-bottom: 10px;
            display: block;
            color: #3498db;
        }
        
        .menu-item.active i {
            color: white;
        }
        
        /* ÂÖßÂÆπÂçÄÂüü */
        .admin-content {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            min-height: 400px;
        }
        
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
        }
        
        .section-title {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            font-size: 1.3em;
        }
        
        /* Ë°®ÂñÆÊ®£Âºè */
        .form-grid {
            display: grid;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .form-group label {
            font-weight: bold;
            color: #2c3e50;
            font-size: 14px;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #3498db;
            outline: none;
        }
        
        /* ÊåâÈàïÊ®£Âºè */
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
            min-height: 48px; /* ÊâãÊ©üÁ´ØÂèãÂ•ΩÁöÑÊúÄÂ∞èËß∏ÊéßÂçÄÂüü */
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Âç°ÁâáÊ®£Âºè */
        .card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #3498db;
        }
        
        .card-header {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        /* Ë°®Ê†ºÊ®£Âºè */
        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .mobile-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .mobile-table th,
        .mobile-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .mobile-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #2c3e50;
            position: sticky;
            top: 0;
        }
        
        /* ÁãÄÊÖãÊ®ôÁ±§ */
        .status-badge {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-active {
            background: #d4edda;
            color: #155724;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-inactive {
            background: #f8d7da;
            color: #721c24;
        }
        
        /* ÈÄöÁü•Ê®£Âºè */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            max-width: 300px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success { background: #27ae60; }
        .notification.error { background: #e74c3c; }
        .notification.info { background: #3498db; }
        
        /* ËºâÂÖ•ÂãïÁï´ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ÁÖßÁâáÁÆ°ÁêÜÊ®£Âºè */
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .photo-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .photo-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }
        
        .photo-thumbnail {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
        }
        
        .photo-info {
            font-size: 14px;
        }
        
        .photo-type {
            background: #3498db;
            color: white;
            padding: 2px 8px;
            border-radius: 15px;
            font-size: 12px;
            display: inline-block;
            margin-bottom: 5px;
        }
        
        .photo-type.revenue {
            background: #27ae60;
        }
        
        .photo-type.maintenance {
            background: #e67e22;
        }
        
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .stat-label {
            display: block;
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .stat-value {
            display: block;
            color: #2c3e50;
            font-size: 24px;
            font-weight: bold;
        }
        
        .pagination-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .pagination-buttons button {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            margin: 0 5px;
            cursor: pointer;
        }
        
        .pagination-buttons button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .card-actions {
            float: right;
        }
        
        .card-actions .btn {
            margin-left: 10px;
        }
        
        /* ÈüøÊáâÂºèË®≠Ë®à */
        @media (min-width: 768px) {
            .container {
                max-width: 1200px;
                padding: 20px;
            }
            
            .admin-menu {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .form-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
        }
        
        @media (max-width: 480px) {
            .admin-header h1 {
                font-size: 1.5em;
            }
            
            .admin-menu {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .menu-item {
                padding: 15px 10px;
            }
            
            .menu-item i {
                font-size: 1.5em;
            }
        }
        
        /* Èö±ËóèÂÖÉÁ¥† */
        .hidden {
            display: none !important;
        }
        
        /* ÂàÜÂ∫óË®≠ÂÆöÁâπÊÆäÊ®£Âºè */
        .store-grid {
            display: grid;
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .store-grid {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            }
        }
        
        .store-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #3498db;
        }
        
        .store-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        /* Âì°Â∑•ÁÆ°ÁêÜÊ®£Âºè */
        .employee-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .employee-info {
            flex: 1;
            min-width: 200px;
        }
        
        .employee-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .employee-actions .btn {
            padding: 8px 12px;
            font-size: 14px;
            min-height: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ÁÆ°ÁêÜÂì°Ê®ôÈ°å -->
        <div class="admin-header">
            <h1><i class="fas fa-user-shield"></i> ÁÆ°ÁêÜÂì°Á≥ªÁµ±</h1>
            <p>‰ºÅÊ•≠Âì°Â∑•ÁÆ°ÁêÜÁ≥ªÁµ± - ÂÆåÊï¥ÂäüËÉΩÁâà</p>
        </div>
        
        <!-- ÂäüËÉΩÈÅ∏ÂñÆ -->
        <div class="admin-menu">
            <button class="menu-item active" onclick="showSection('dashboard')">
                <i class="fas fa-tachometer-alt"></i>
                Á≥ªÁµ±Á∏ΩË¶Ω
            </button>
            <button class="menu-item" onclick="showSection('stores')">
                <i class="fas fa-store"></i>
                ÂàÜÂ∫óË®≠ÂÆö
            </button>
            <button class="menu-item" onclick="showSection('employees')">
                <i class="fas fa-users"></i>
                Âì°Â∑•ÁÆ°ÁêÜ
            </button>
            <button class="menu-item" onclick="showSection('ordering')">
                <i class="fas fa-shopping-cart"></i>
                Âè´Ë≤®ÂìÅÈ†Ö
            </button>
            <button class="menu-item" onclick="showSection('schedule')">
                <i class="fas fa-calendar-alt"></i>
                ÊéíÁè≠Ë®≠ÂÆö
            </button>
            <button class="menu-item" onclick="showSection('voting')">
                <i class="fas fa-vote-yea"></i>
                ÊäïÁ•®Ë®≠ÂÆö
            </button>
            <button class="menu-item" onclick="showSection('revenue')">
                <i class="fas fa-dollar-sign"></i>
                ÁáüÊî∂Ë®≠ÂÆö
            </button>
            <button class="menu-item" onclick="showSection('photos')">
                <i class="fas fa-images"></i>
                ÁÖßÁâáÁÆ°ÁêÜ
            </button>
            <button class="menu-item" onclick="showSection('system')">
                <i class="fas fa-cogs"></i>
                Á≥ªÁµ±Ë®≠ÂÆö
            </button>
        </div>
        
        <!-- ÂÖßÂÆπÂçÄÂüü -->
        <div class="admin-content">
            <!-- Á≥ªÁµ±Á∏ΩË¶Ω -->
            <div id="dashboard" class="content-section active">
                <h2 class="section-title">
                    <i class="fas fa-tachometer-alt"></i> Á≥ªÁµ±Á∏ΩË¶Ω
                </h2>
                
                <div class="form-grid">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-users"></i> Âì°Â∑•Áµ±Ë®à
                        </div>
                        <div id="employee-stats">ËºâÂÖ•‰∏≠...</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-store"></i> ÂàÜÂ∫óÁµ±Ë®à
                        </div>
                        <div id="store-stats">ËºâÂÖ•‰∏≠...</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-chart-line"></i> ‰ªäÊó•Êï∏Êìö
                        </div>
                        <div id="daily-stats">ËºâÂÖ•‰∏≠...</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-bell"></i> Á≥ªÁµ±ÁãÄÊÖã
                        </div>
                        <div id="system-status">ËºâÂÖ•‰∏≠...</div>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="testAllAPIs()">
                    <i class="fas fa-flask"></i> Ê∏¨Ë©¶ÊâÄÊúâAPI
                </button>
            </div>
            
            <!-- ÂàÜÂ∫óË®≠ÂÆö -->
            <div id="stores" class="content-section">
                <h2 class="section-title">
                    <i class="fas fa-store"></i> ÂàÜÂ∫óÁÆ°ÁêÜË®≠ÂÆö
                </h2>
                
                <div class="store-grid" id="stores-container">
                    <!-- ÂàÜÂ∫óÂç°ÁâáÂ∞áÁî±JavaScriptÂãïÊÖãÁîüÊàê -->
                </div>
                
                <button class="btn btn-success" onclick="showAddStoreForm()">
                    <i class="fas fa-plus"></i> Êñ∞Â¢ûÂàÜÂ∫ó
                </button>
            </div>
            
            <!-- Âì°Â∑•ÁÆ°ÁêÜ -->
            <div id="employees" class="content-section">
                <h2 class="section-title">
                    <i class="fas fa-users"></i> Âì°Â∑•Ë≥áÊñôÁÆ°ÁêÜ
                </h2>
                
                <div class="form-group">
                    <button class="btn btn-primary" onclick="loadEmployees()">
                        <i class="fas fa-sync"></i> ÈáçÊñ∞ËºâÂÖ•Âì°Â∑•ÂàóË°®
                    </button>
                </div>
                
                <div id="employees-container">
                    <!-- Âì°Â∑•ÂàóË°®Â∞áÁî±JavaScriptÂãïÊÖãÁîüÊàê -->
                </div>
            </div>
            
            <!-- Âè´Ë≤®ÂìÅÈ†Ö -->
            <div id="ordering" class="content-section">
                <h2 class="section-title">
                    <i class="fas fa-shopping-cart"></i> Âè´Ë≤®ÂìÅÈ†ÖÊ∏ÖÂñÆË®≠ÂÆö
                </h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="item-supplier">‰æõÊáâÂïÜ</label>
                        <input type="text" id="item-supplier" placeholder="‰æãÔºöËÅØËèØÈ£üÂìÅ">
                    </div>
                    <div class="form-group">
                        <label for="item-brand">ÂìÅÁâå</label>
                        <input type="text" id="item-brand" placeholder="‰æãÔºöÈ£õÈ£õ">
                    </div>
                    <div class="form-group">
                        <label for="item-product">ÂìÅÈ†Ö</label>
                        <input type="text" id="item-product" placeholder="‰æãÔºöÈõûËÉ∏ËÇâ">
                    </div>
                    <div class="form-group">
                        <label for="item-unit">ÂñÆ‰Ωç</label>
                        <input type="text" id="item-unit" placeholder="‰æãÔºö‰ªΩ">
                    </div>
                    <div class="form-group">
                        <label for="item-price">ÂñÆÂÉπ</label>
                        <input type="number" id="item-price" placeholder="150">
                    </div>
                    <div class="form-group">
                        <label for="item-category">È°ûÂà•</label>
                        <select id="item-category">
                            <option value="">Ë´ãÈÅ∏ÊìáÈ°ûÂà•</option>
                            <option value="ËÇâÈ°û">ËÇâÈ°û</option>
                            <option value="ÈÖçËèú">ÈÖçËèú</option>
                            <option value="ÂéüÊñô">ÂéüÊñô</option>
                            <option value="Ë™øÊñô">Ë™øÊñô</option>
                            <option value="‰∏ªÈ£ü">‰∏ªÈ£ü</option>
                            <option value="È£≤Êñô">È£≤Êñô</option>
                            <option value="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</option>
                        </select>
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="addOrderingItem()">
                    <i class="fas fa-plus"></i> Êñ∞Â¢ûÂìÅÈ†Ö
                </button>
                
                <div id="ordering-items-container">
                    <!-- ÂìÅÈ†ÖÂàóË°®Â∞áÁî±JavaScriptÂãïÊÖãÁîüÊàê -->
                </div>
            </div>
            
            <!-- ÊéíÁè≠Ë®≠ÂÆö -->
            <div id="schedule" class="content-section">
                <h2 class="section-title">
                    <i class="fas fa-calendar-alt"></i> ÊéíÁè≠Á≥ªÁµ±ÂèÉÊï∏Ë®≠ÂÆö
                </h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="max-vacation-days">ÊØè‰∫∫‰ºëÂÅá‰∏äÈôêÂ§©Êï∏</label>
                        <input type="number" id="max-vacation-days" value="8">
                    </div>
                    <div class="form-group">
                        <label for="max-daily-vacation">ÊØèÊó•‰ºëÂÅáÁ∏Ω‰∏äÈôê‰∫∫Êï∏</label>
                        <input type="number" id="max-daily-vacation" value="2">
                    </div>
                    <div class="form-group">
                        <label for="max-weekend-vacation">ÈÄ±Êú´‰ºëÂÅá‰∏äÈôêÂ§©Êï∏</label>
                        <input type="number" id="max-weekend-vacation" value="3">
                    </div>
                    <div class="form-group">
                        <label for="operation-time">ÊéíÁè≠Êìç‰ΩúÊôÇÈñì(ÂàÜÈêò)</label>
                        <input type="number" id="operation-time" value="5">
                    </div>
                    <div class="form-group">
                        <label for="open-day">ÊéíÁè≠ÈñãÂïüÊó•Êúü</label>
                        <input type="number" id="open-day" value="16" min="1" max="31">
                    </div>
                    <div class="form-group">
                        <label for="close-day">ÊéíÁè≠ÈóúÈñâÊó•Êúü</label>
                        <input type="number" id="close-day" value="21" min="1" max="31">
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="saveScheduleSettings()">
                    <i class="fas fa-save"></i> ÂÑ≤Â≠òÊéíÁè≠Ë®≠ÂÆö
                </button>
            </div>
            
            <!-- ÊäïÁ•®Ë®≠ÂÆö -->
            <div id="voting" class="content-section">
                <h2 class="section-title">
                    <i class="fas fa-vote-yea"></i> ÊäïÁ•®ÈöéÁ¥öÂèÉÊï∏Ë®≠ÂÆö
                </h2>
                
                <div id="voting-positions-container">
                    <!-- ËÅ∑‰ΩçË®≠ÂÆöÂ∞áÁî±JavaScriptÂãïÊÖãÁîüÊàê -->
                </div>
                
                <button class="btn btn-success" onclick="showAddPositionForm()">
                    <i class="fas fa-plus"></i> Êñ∞Â¢ûËÅ∑‰Ωç
                </button>
            </div>
            
            <!-- ÁáüÊî∂Ë®≠ÂÆö -->
            <div id="revenue" class="content-section">
                <h2 class="section-title">
                    <i class="fas fa-dollar-sign"></i> ÁáüÊî∂ÁçéÈáëÂÖ¨ÂºèË®≠ÂÆö
                </h2>
                
                <div class="card">
                    <div class="card-header">Âπ≥Êó•ÁçéÈáëÂÖ¨Âºè</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="weekday-threshold">ÁçéÈáëÈñÄÊ™ª</label>
                            <input type="number" id="weekday-threshold" value="13000">
                        </div>
                        <div class="form-group">
                            <label for="weekday-rate">ÁçéÈáëÊØî‰æã(%)</label>
                            <input type="number" id="weekday-rate" value="30" step="0.1">
                        </div>
                    </div>
                    <p>ÂÖ¨ÂºèÔºöÁèæÂ†¥ÈáëÈ°ç + ÁÜäË≤ìÈáëÈ°ç(Êâ£Èô§35%ÊúçÂãôË≤ª) + UBERÈáëÈ°ç(Êâ£Èô§35%ÊúçÂãôË≤ª) > <span id="weekday-display">13000</span> ÂâáÂèñ <span id="weekday-rate-display">30%</span> ‰ΩúÁÇ∫ÁçéÈáë</p>
                </div>
                
                <div class="card">
                    <div class="card-header">ÂÅáÊó•ÁçéÈáëÂÖ¨Âºè</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="holiday-threshold">ÁçéÈáëÈñÄÊ™ª</label>
                            <input type="number" id="holiday-threshold" value="0">
                        </div>
                        <div class="form-group">
                            <label for="holiday-rate">ÁçéÈáëÊØî‰æã(%)</label>
                            <input type="number" id="holiday-rate" value="38" step="0.1">
                        </div>
                    </div>
                    <p>ÂÖ¨ÂºèÔºöÁ∏ΩÈáëÈ°ç >= <span id="holiday-display">0</span> ÂâáÂèñ <span id="holiday-rate-display">38%</span> ‰ΩúÁÇ∫ÁçéÈáë</p>
                </div>
                
                <button class="btn btn-success" onclick="saveRevenueSettings()">
                    <i class="fas fa-save"></i> ÂÑ≤Â≠òÁáüÊî∂Ë®≠ÂÆö
                </button>
            </div>
            
            <!-- ÁÖßÁâáÁÆ°ÁêÜ -->
            <div id="photos" class="content-section">
                <h2 class="section-title">
                    <i class="fas fa-images"></i> ÁÖßÁâáÁÆ°ÁêÜ
                </h2>
                
                <!-- ÁÖßÁâáÁµ±Ë®à -->
                <div class="card">
                    <div class="card-header">ÁÖßÁâáÁµ±Ë®à</div>
                    <div id="photo-stats" class="form-grid">
                        <div class="stat-item">
                            <span class="stat-label">Á∏ΩÁÖßÁâáÊï∏</span>
                            <span class="stat-value" id="total-photos">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">ÁáüÊî∂ÁÖßÁâá</span>
                            <span class="stat-value" id="revenue-photos">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Á∂≠‰øÆÁÖßÁâá</span>
                            <span class="stat-value" id="maintenance-photos">0</span>
                        </div>
                    </div>
                </div>
                
                <!-- ÁÖßÁâáÁØ©ÈÅ∏ -->
                <div class="card">
                    <div class="card-header">ÁÖßÁâáÊü•Ë©¢ÁØ©ÈÅ∏</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="photo-type">ÁÖßÁâáÈ°ûÂûã</label>
                            <select id="photo-type">
                                <option value="">ÂÖ®ÈÉ®</option>
                                <option value="revenue">ÁáüÊî∂ÁÖßÁâá</option>
                                <option value="maintenance">Á∂≠‰øÆÁÖßÁâá</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="photo-store">ÂàÜÂ∫ó</label>
                            <select id="photo-store">
                                <option value="">ÂÖ®ÈÉ®ÂàÜÂ∫ó</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="photo-start-date">ÈñãÂßãÊó•Êúü</label>
                            <input type="date" id="photo-start-date">
                        </div>
                        <div class="form-group">
                            <label for="photo-end-date">ÁµêÊùüÊó•Êúü</label>
                            <input type="date" id="photo-end-date">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="searchPhotos()">
                        <i class="fas fa-search"></i> ÊêúÂ∞ãÁÖßÁâá
                    </button>
                </div>
                
                <!-- ÁÖßÁâáÂàóË°® -->
                <div class="card">
                    <div class="card-header">
                        ÁÖßÁâáÂàóË°®
                        <div class="card-actions">
                            <button class="btn btn-secondary" onclick="refreshPhotos()">
                                <i class="fas fa-sync"></i> ÈáçÊñ∞Êï¥ÁêÜ
                            </button>
                        </div>
                    </div>
                    
                    <!-- ÂàÜÈ†ÅÊéßÂà∂ -->
                    <div class="pagination-controls">
                        <span id="photo-pagination-info">Á¨¨ 1 È†ÅÔºåÂÖ± 0 Á≠Ü</span>
                        <div class="pagination-buttons">
                            <button id="photo-prev-page" onclick="changePhotoPage(-1)" disabled>
                                <i class="fas fa-chevron-left"></i> ‰∏ä‰∏ÄÈ†Å
                            </button>
                            <button id="photo-next-page" onclick="changePhotoPage(1)" disabled>
                                <i class="fas fa-chevron-right"></i> ‰∏ã‰∏ÄÈ†Å
                            </button>
                        </div>
                    </div>
                    
                    <!-- ÁÖßÁâáÁ∂≤Ê†º -->
                    <div id="photo-grid" class="photo-grid">
                        <div class="loading">ËºâÂÖ•‰∏≠...</div>
                    </div>
                </div>
            </div>
            
            <!-- Á≥ªÁµ±Ë®≠ÂÆö -->
            <div id="system" class="content-section">
                <h2 class="section-title">
                    <i class="fas fa-cogs"></i> Á≥ªÁµ±Ë®≠ÂÆö
                </h2>
                
                <div class="card">
                    <div class="card-header">‰ΩúÂª¢ÂäüËÉΩÈñãÈóú</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="void-attendance" checked> ËÄÉÂã§Ë®òÈåÑÂèØ‰ΩúÂª¢
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="void-revenue" checked> ÁáüÊî∂Ë®òÈåÑÂèØ‰ΩúÂª¢
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="void-ordering" checked> Âè´Ë≤®Ë®òÈåÑÂèØ‰ΩúÂª¢
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="void-maintenance" checked> Á∂≠‰øÆË®òÈåÑÂèØ‰ΩúÂª¢
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">TelegramÈÄöÁü•Ë®≠ÂÆö</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="bot-token">Bot Token</label>
                            <input type="text" id="bot-token" value="7659930552:AAF_jF1rAXFnjFO176-9X5fKfBwbrko8BNc">
                        </div>
                        <div class="form-group">
                            <label for="boss-group">ËÄÅÈóÜÁæ§ÁµÑID</label>
                            <input type="text" id="boss-group" value="-1002658082392">
                        </div>
                        <div class="form-group">
                            <label for="employee-group">Âì°Â∑•Áæ§ÁµÑID</label>
                            <input type="text" id="employee-group" value="-1002658082392">
                        </div>
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="saveSystemSettings()">
                    <i class="fas fa-save"></i> ÂÑ≤Â≠òÁ≥ªÁµ±Ë®≠ÂÆö
                </button>
            </div>
        </div>
    </div>

    <script>
        // ÂÖ®ÂüüËÆäÊï∏
        let currentSection = 'dashboard';
        let systemData = {};
        
        // È†ÅÈù¢ËºâÂÖ•ÊôÇÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            loadSystemData();
            loadDashboard();
        });
        
        // È°ØÁ§∫ÊåáÂÆöÂçÄÂ°ä
        function showSection(sectionName) {
            // Èö±ËóèÊâÄÊúâÂçÄÂ°ä
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // ÁßªÈô§ÊâÄÊúâÈÅ∏ÂñÆÈ†ÖÁõÆÁöÑactiveÁãÄÊÖã
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // È°ØÁ§∫ÊåáÂÆöÂçÄÂ°ä
            document.getElementById(sectionName).classList.add('active');
            
            // Ë®≠ÂÆöÂ∞çÊáâÈÅ∏ÂñÆÈ†ÖÁõÆÁÇ∫active
            event.target.classList.add('active');
            
            currentSection = sectionName;
            
            // ËºâÂÖ•Â∞çÊáâÊï∏Êìö
            switch(sectionName) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'stores':
                    loadStores();
                    break;
                case 'employees':
                    loadEmployees();
                    break;
                case 'ordering':
                    loadOrderingItems();
                    break;
                case 'schedule':
                    loadScheduleSettings();
                    break;
                case 'voting':
                    loadVotingPositions();
                    break;
                case 'revenue':
                    loadRevenueSettings();
                    break;
                case 'photos':
                    loadPhotoManagement();
                    break;
                case 'system':
                    loadSystemSettings();
                    break;
            }
        }
        
        // ËºâÂÖ•Á≥ªÁµ±Êï∏Êìö
        async function loadSystemData() {
            try {
                const response = await fetch('/api/health');
                systemData = await response.json();
            } catch (error) {
                console.error('ËºâÂÖ•Á≥ªÁµ±Êï∏ÊìöÂ§±Êïó:', error);
            }
        }
        
        // ËºâÂÖ•Á≥ªÁµ±Á∏ΩË¶Ω
        async function loadDashboard() {
            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                
                // Êõ¥Êñ∞Âì°Â∑•Áµ±Ë®à
                document.getElementById('employee-stats').innerHTML = `
                    <p><strong>Á∏ΩÂì°Â∑•Êï∏:</strong> ${data.statistics.totalEmployees} ‰∫∫</p>
                    <p><strong>ÂàÜÂ∫óÊï∏:</strong> ${data.statistics.totalStores} Èñì</p>
                `;
                
                // Êõ¥Êñ∞ÂàÜÂ∫óÁµ±Ë®à
                document.getElementById('store-stats').innerHTML = `
                    <p><strong>ÂÖßÂ£¢Âø†Â≠ùÂ∫ó:</strong> ÁáüÈÅã‰∏≠</p>
                    <p><strong>Ê°ÉÂúíÈæçÂÆâÂ∫ó:</strong> ÁáüÈÅã‰∏≠</p>
                    <p><strong>‰∏≠Â£¢ÈæçÂ¥óÂ∫ó:</strong> ÁáüÈÅã‰∏≠</p>
                `;
                
                // Êõ¥Êñ∞‰ªäÊó•Êï∏Êìö
                document.getElementById('daily-stats').innerHTML = `
                    <p><strong>ËÄÉÂã§Ë®òÈåÑ:</strong> ${data.statistics.attendanceRecords} Á≠Ü</p>
                    <p><strong>ÁáüÊî∂Ë®òÈåÑ:</strong> ${data.statistics.revenueRecords} Á≠Ü</p>
                    <p><strong>Âè´Ë≤®Ë®òÈåÑ:</strong> ${data.statistics.orderingRecords} Á≠Ü</p>
                    <p><strong>Á∂≠‰øÆË®òÈåÑ:</strong> ${data.statistics.maintenanceRecords} Á≠Ü</p>
                `;
                
                // Êõ¥Êñ∞Á≥ªÁµ±ÁãÄÊÖã
                document.getElementById('system-status').innerHTML = `
                    <p><strong>Á≥ªÁµ±ÁâàÊú¨:</strong> ${data.version}</p>
                    <p><strong>ÊúçÂãôÁãÄÊÖã:</strong> <span class="status-badge status-active">Ê≠£Â∏∏ÈÅãË°å</span></p>
                    <p><strong>‰∏äÊ¨°Êõ¥Êñ∞:</strong> ${new Date().toLocaleString('zh-TW')}</p>
                `;
                
            } catch (error) {
                showNotification('ËºâÂÖ•Á≥ªÁµ±Á∏ΩË¶ΩÂ§±Êïó', 'error');
            }
        }
        
        // Ê∏¨Ë©¶ÊâÄÊúâAPI
        async function testAllAPIs() {
            const testButton = event.target;
            testButton.disabled = true;
            testButton.innerHTML = '<div class="loading"></div> Ê∏¨Ë©¶‰∏≠...';
            
            const apis = [
                '/api/health',
                '/api/admin/employees', 
                '/api/attendance',
                '/api/revenue',
                '/api/ordering',
                '/api/maintenance'
            ];
            
            let results = [];
            
            for (let api of apis) {
                try {
                    const response = await fetch(api);
                    const status = response.ok ? '‚úÖ' : '‚ùå';
                    results.push(`${status} ${api}: ${response.ok ? 'Ê≠£Â∏∏' : 'ÈåØË™§'} (${response.status})`);
                } catch (error) {
                    results.push(`‚ùå ${api}: ÈÄ£Á∑öÂ§±Êïó`);
                }
            }
            
            alert(`APIÊ∏¨Ë©¶ÁµêÊûú:\n\n${results.join('\n')}`);
            
            testButton.disabled = false;
            testButton.innerHTML = '<i class="fas fa-flask"></i> Ê∏¨Ë©¶ÊâÄÊúâAPI';
        }
        
        // ËºâÂÖ•ÂàÜÂ∫óË®≠ÂÆö
        async function loadStores() {
            try {
                const response = await fetch('/api/admin/stores');
                const data = await response.json();
                
                if (data.success) {
                    const container = document.getElementById('stores-container');
                    container.innerHTML = '';
                    
                    data.data.forEach(store => {
                        const storeCard = document.createElement('div');
                        storeCard.className = 'store-card';
                        storeCard.innerHTML = `
                            <h3>${store.name}</h3>
                            <p><strong>Âú∞ÂùÄ:</strong> ${store.address}</p>
                            <p><strong>ÁáüÊ•≠ÊôÇÈñì:</strong> ${store.open}</p>
                            <p><strong>ÊúÄÂ∞ë‰∫∫Êï∏:</strong> ${store.people} ‰∫∫</p>
                            <p><strong>ÊâìÂç°ÁØÑÂúç:</strong> ${store.radius} ÂÖ¨Â∞∫</p>
                            <p><strong>Â∫ßÊ®ô:</strong> ${store.latitude}, ${store.longitude}</p>
                            <button class="btn btn-primary" onclick="editStore('${store.storeId}')">
                                <i class="fas fa-edit"></i> Á∑®ËºØ
                            </button>
                        `;
                        container.appendChild(storeCard);
                    });
                }
            } catch (error) {
                showNotification('ËºâÂÖ•ÂàÜÂ∫óË≥áÊñôÂ§±Êïó', 'error');
            }
        }
        
        // ËºâÂÖ•Âì°Â∑•ÂàóË°®
        async function loadEmployees() {
            try {
                const response = await fetch('/api/admin/employees');
                const data = await response.json();
                
                if (data.success) {
                    const container = document.getElementById('employees-container');
                    container.innerHTML = '';
                    
                    data.data.forEach(employee => {
                        const employeeCard = document.createElement('div');
                        employeeCard.className = 'employee-card';
                        
                        const statusClass = employee.isActive ? 'status-active' : 
                                           employee.status === 'ÂØ©Ê†∏‰∏≠' ? 'status-pending' : 'status-inactive';
                        
                        employeeCard.innerHTML = `
                            <div class="employee-info">
                                <h4>${employee.name}</h4>
                                <p><strong>Á∑®Ëôü:</strong> ${employee.employeeId}</p>
                                <p><strong>ËÅ∑‰Ωç:</strong> ${employee.position}</p>
                                <p><strong>ÂàÜÂ∫ó:</strong> ${employee.store}</p>
                                <p><strong>ÁãÄÊÖã:</strong> <span class="status-badge ${statusClass}">${employee.status}</span></p>
                            </div>
                            <div class="employee-actions">
                                <button class="btn btn-primary" onclick="editEmployee('${employee.employeeId}')">
                                    <i class="fas fa-edit"></i> Á∑®ËºØ
                                </button>
                                ${!employee.isActive ? 
                                    `<button class="btn btn-success" onclick="approveEmployee('${employee.employeeId}')">
                                        <i class="fas fa-check"></i> ÂØ©Ê†∏ÈÄöÈÅé
                                    </button>` : ''
                                }
                            </div>
                        `;
                        container.appendChild(employeeCard);
                    });
                }
            } catch (error) {
                showNotification('ËºâÂÖ•Âì°Â∑•Ë≥áÊñôÂ§±Êïó', 'error');
            }
        }
        
        // ÂØ©Ê†∏ÈÄöÈÅéÂì°Â∑•
        async function approveEmployee(employeeId) {
            if (!confirm('Á¢∫ÂÆöË¶ÅÂØ©Ê†∏ÈÄöÈÅéÊ≠§Âì°Â∑•ÂóéÔºü')) return;
            
            try {
                const response = await fetch(`/api/admin/employees/${employeeId}`, {
                    method: 'PUT',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        isActive: true,
                        status: 'Âú®ËÅ∑'
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('Âì°Â∑•ÂØ©Ê†∏ÈÄöÈÅé', 'success');
                    loadEmployees();
                } else {
                    showNotification(data.message, 'error');
                }
            } catch (error) {
                showNotification('ÂØ©Ê†∏Â§±Êïó', 'error');
            }
        }
        
        // ËºâÂÖ•Âè´Ë≤®ÂìÅÈ†Ö
        async function loadOrderingItems() {
            try {
                const response = await fetch('/api/admin/ordering-items');
                const data = await response.json();
                
                if (data.success) {
                    const container = document.getElementById('ordering-items-container');
                    container.innerHTML = '<h3>ÁõÆÂâçÂìÅÈ†ÖÊ∏ÖÂñÆ</h3>';
                    
                    // Êåâ‰æõÊáâÂïÜÂàÜÁµÑ
                    const groupedItems = {};
                    data.data.forEach(item => {
                        if (!groupedItems[item.supplier]) {
                            groupedItems[item.supplier] = [];
                        }
                        groupedItems[item.supplier].push(item);
                    });
                    
                    Object.keys(groupedItems).forEach(supplier => {
                        const supplierDiv = document.createElement('div');
                        supplierDiv.className = 'card';
                        supplierDiv.innerHTML = `
                            <div class="card-header">üè≠ ${supplier}</div>
                            ${groupedItems[supplier].map(item => `
                                <p>‚Ä¢ ${item.brand} ${item.product} - $${item.unitPrice}/${item.unit}</p>
                            `).join('')}
                        `;
                        container.appendChild(supplierDiv);
                    });
                }
            } catch (error) {
                showNotification('ËºâÂÖ•ÂìÅÈ†ÖÊ∏ÖÂñÆÂ§±Êïó', 'error');
            }
        }
        
        // Êñ∞Â¢ûÂè´Ë≤®ÂìÅÈ†Ö
        async function addOrderingItem() {
            const formData = {
                supplier: document.getElementById('item-supplier').value,
                brand: document.getElementById('item-brand').value,
                product: document.getElementById('item-product').value,
                unit: document.getElementById('item-unit').value,
                unitPrice: parseFloat(document.getElementById('item-price').value),
                category: document.getElementById('item-category').value
            };
            
            // È©óË≠âË°®ÂñÆ
            if (!formData.supplier || !formData.brand || !formData.product || !formData.unit || !formData.unitPrice || !formData.category) {
                showNotification('Ë´ãÂ°´ÂØ´ÊâÄÊúâÊ¨Ñ‰Ωç', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/admin/ordering-items', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(formData)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('ÂìÅÈ†ÖÊñ∞Â¢ûÊàêÂäü', 'success');
                    // Ê∏ÖÁ©∫Ë°®ÂñÆ
                    document.querySelectorAll('#ordering input, #ordering select').forEach(input => {
                        input.value = '';
                    });
                    loadOrderingItems();
                } else {
                    showNotification(data.message, 'error');
                }
            } catch (error) {
                showNotification('Êñ∞Â¢ûÂìÅÈ†ÖÂ§±Êïó', 'error');
            }
        }
        
        // ËºâÂÖ•ÊéíÁè≠Ë®≠ÂÆö
        async function loadScheduleSettings() {
            try {
                const response = await fetch('/api/admin/settings');
                const data = await response.json();
                
                if (data.success && data.data.scheduling) {
                    const settings = data.data.scheduling;
                    document.getElementById('max-vacation-days').value = settings.maxVacationDays;
                    document.getElementById('max-daily-vacation').value = settings.maxDailyVacationTotal;
                    document.getElementById('max-weekend-vacation').value = settings.maxWeekendVacationDays;
                    document.getElementById('operation-time').value = settings.operationTimeMinutes;
                    document.getElementById('open-day').value = settings.openDay;
                    document.getElementById('close-day').value = settings.closeDay;
                }
            } catch (error) {
                showNotification('ËºâÂÖ•ÊéíÁè≠Ë®≠ÂÆöÂ§±Êïó', 'error');
            }
        }
        
        // ÂÑ≤Â≠òÊéíÁè≠Ë®≠ÂÆö
        async function saveScheduleSettings() {
            const settings = {
                maxVacationDays: parseInt(document.getElementById('max-vacation-days').value),
                maxDailyVacationTotal: parseInt(document.getElementById('max-daily-vacation').value),
                maxWeekendVacationDays: parseInt(document.getElementById('max-weekend-vacation').value),
                operationTimeMinutes: parseInt(document.getElementById('operation-time').value),
                openDay: parseInt(document.getElementById('open-day').value),
                closeDay: parseInt(document.getElementById('close-day').value)
            };
            
            try {
                const response = await fetch('/api/admin/settings', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        category: 'scheduling',
                        settings: settings
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('ÊéíÁè≠Ë®≠ÂÆöÂÑ≤Â≠òÊàêÂäü', 'success');
                } else {
                    showNotification(data.message, 'error');
                }
            } catch (error) {
                showNotification('ÂÑ≤Â≠òÊéíÁè≠Ë®≠ÂÆöÂ§±Êïó', 'error');
            }
        }
        
        // ËºâÂÖ•ÊäïÁ•®ËÅ∑‰ΩçË®≠ÂÆö
        async function loadVotingPositions() {
            try {
                const response = await fetch('/api/admin/settings');
                const data = await response.json();
                
                if (data.success && data.data.voting && data.data.voting.positions) {
                    const container = document.getElementById('voting-positions-container');
                    container.innerHTML = '';
                    
                    data.data.voting.positions.forEach(position => {
                        const positionCard = document.createElement('div');
                        positionCard.className = 'card';
                        positionCard.innerHTML = `
                            <div class="card-header">ÈöéÁ¥ö ${position.level} - ${position.name}</div>
                            <p><strong>Ëñ™Ë≥á:</strong> $${position.salary.toLocaleString()}</p>
                            <p><strong>ÁçéÈáëÊØî‰æã:</strong> ${(position.bonusRate * 100)}%</p>
                            <p><strong>ÂêçÈ°ç:</strong> ${position.quota} ‰∫∫</p>
                            <p><strong>‰ªªËÅ∑ÈúÄÊªø:</strong> ${position.requiredDays} Â§©</p>
                            <p><strong>ÂêåÊÑèÊØî‰æã:</strong> ${(position.approvalRate * 100)}%</p>
                            <p><strong>ÊäïÁ•®ÊúüÈñì:</strong> ${position.votingPeriodDays} Â§©</p>
                            <p><strong>ÈÅ≤Âà∞ÈôêÂà∂:</strong> ÊØèÊúà‰∏çË∂ÖÈÅé ${position.maxLateMinutesPerMonth} ÂàÜÈêò</p>
                            <p><strong>ÂÇôË®ª:</strong> ${position.notes}</p>
                        `;
                        container.appendChild(positionCard);
                    });
                }
            } catch (error) {
                showNotification('ËºâÂÖ•ÊäïÁ•®Ë®≠ÂÆöÂ§±Êïó', 'error');
            }
        }
        
        // ËºâÂÖ•ÁáüÊî∂Ë®≠ÂÆö
        async function loadRevenueSettings() {
            try {
                const response = await fetch('/api/admin/settings');
                const data = await response.json();
                
                if (data.success && data.data.revenue) {
                    const revenue = data.data.revenue;
                    
                    document.getElementById('weekday-threshold').value = revenue.weekdayFormula.threshold;
                    document.getElementById('weekday-rate').value = revenue.weekdayFormula.rate * 100;
                    document.getElementById('holiday-threshold').value = revenue.holidayFormula.threshold;
                    document.getElementById('holiday-rate').value = revenue.holidayFormula.rate * 100;
                    
                    updateRevenueDisplay();
                }
            } catch (error) {
                showNotification('ËºâÂÖ•ÁáüÊî∂Ë®≠ÂÆöÂ§±Êïó', 'error');
            }
        }
        
        // Êõ¥Êñ∞ÁáüÊî∂È°ØÁ§∫
        function updateRevenueDisplay() {
            document.getElementById('weekday-display').textContent = document.getElementById('weekday-threshold').value;
            document.getElementById('weekday-rate-display').textContent = document.getElementById('weekday-rate').value + '%';
            document.getElementById('holiday-display').textContent = document.getElementById('holiday-threshold').value;
            document.getElementById('holiday-rate-display').textContent = document.getElementById('holiday-rate').value + '%';
        }
        
        // ÂÑ≤Â≠òÁáüÊî∂Ë®≠ÂÆö
        async function saveRevenueSettings() {
            const settings = {
                weekdayFormula: {
                    threshold: parseFloat(document.getElementById('weekday-threshold').value),
                    rate: parseFloat(document.getElementById('weekday-rate').value) / 100
                },
                holidayFormula: {
                    threshold: parseFloat(document.getElementById('holiday-threshold').value),
                    rate: parseFloat(document.getElementById('holiday-rate').value) / 100
                }
            };
            
            try {
                const response = await fetch('/api/admin/settings', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        category: 'revenue',
                        settings: settings
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('ÁáüÊî∂Ë®≠ÂÆöÂÑ≤Â≠òÊàêÂäü', 'success');
                    updateRevenueDisplay();
                } else {
                    showNotification(data.message, 'error');
                }
            } catch (error) {
                showNotification('ÂÑ≤Â≠òÁáüÊî∂Ë®≠ÂÆöÂ§±Êïó', 'error');
            }
        }
        
        // ËºâÂÖ•Á≥ªÁµ±Ë®≠ÂÆö
        async function loadSystemSettings() {
            try {
                const response = await fetch('/api/admin/settings');
                const data = await response.json();
                
                if (data.success) {
                    // ËºâÂÖ•‰ΩúÂª¢Ë®≠ÂÆö
                    if (data.data.voidSettings) {
                        document.getElementById('void-attendance').checked = data.data.voidSettings.attendance;
                        document.getElementById('void-revenue').checked = data.data.voidSettings.revenue;
                        document.getElementById('void-ordering').checked = data.data.voidSettings.ordering;
                        document.getElementById('void-maintenance').checked = data.data.voidSettings.maintenance;
                    }
                    
                    // ËºâÂÖ•TelegramË®≠ÂÆö
                    if (data.data.telegram) {
                        document.getElementById('bot-token').value = data.data.telegram.botToken;
                        document.getElementById('boss-group').value = data.data.telegram.bossGroupId;
                        document.getElementById('employee-group').value = data.data.telegram.employeeGroupId;
                    }
                }
            } catch (error) {
                showNotification('ËºâÂÖ•Á≥ªÁµ±Ë®≠ÂÆöÂ§±Êïó', 'error');
            }
        }
        
        // ÂÑ≤Â≠òÁ≥ªÁµ±Ë®≠ÂÆö
        async function saveSystemSettings() {
            const settings = {
                voidSettings: {
                    attendance: document.getElementById('void-attendance').checked,
                    revenue: document.getElementById('void-revenue').checked,
                    ordering: document.getElementById('void-ordering').checked,
                    maintenance: document.getElementById('void-maintenance').checked
                },
                telegram: {
                    botToken: document.getElementById('bot-token').value,
                    bossGroupId: document.getElementById('boss-group').value,
                    employeeGroupId: document.getElementById('employee-group').value
                }
            };
            
            try {
                // ÂàÜÂà•ÂÑ≤Â≠òÂÖ©ÂÄãË®≠ÂÆöÈ°ûÂà•
                const voidResponse = await fetch('/api/admin/settings', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        category: 'voidSettings',
                        settings: settings.voidSettings
                    })
                });
                
                const telegramResponse = await fetch('/api/admin/settings', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        category: 'telegram',
                        settings: settings.telegram
                    })
                });
                
                const voidData = await voidResponse.json();
                const telegramData = await telegramResponse.json();
                
                if (voidData.success && telegramData.success) {
                    showNotification('Á≥ªÁµ±Ë®≠ÂÆöÂÑ≤Â≠òÊàêÂäü', 'success');
                } else {
                    showNotification('ÈÉ®ÂàÜË®≠ÂÆöÂÑ≤Â≠òÂ§±Êïó', 'error');
                }
            } catch (error) {
                showNotification('ÂÑ≤Â≠òÁ≥ªÁµ±Ë®≠ÂÆöÂ§±Êïó', 'error');
            }
        }
        
        // È°ØÁ§∫ÈÄöÁü•
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'times' : 'info'}"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }
        
        // Áõ£ËÅΩÁáüÊî∂Ë®≠ÂÆöËº∏ÂÖ•ËÆäÂåñ
        document.addEventListener('input', function(e) {
            if (e.target.id.includes('weekday') || e.target.id.includes('holiday')) {
                updateRevenueDisplay();
            }
        });
        
        // ==================== ÁÖßÁâáÁÆ°ÁêÜÂäüËÉΩ ====================
        
        let currentPhotoPage = 1;
        let photoPageSize = 20;
        let totalPhotoPages = 1;
        
        // ËºâÂÖ•ÁÖßÁâáÁÆ°ÁêÜ
        async function loadPhotoManagement() {
            await loadPhotoStats();
            await loadPhotoStores();
            await loadPhotos();
        }
        
        // ËºâÂÖ•ÁÖßÁâáÁµ±Ë®à
        async function loadPhotoStats() {
            try {
                const response = await fetch('/api/admin/photos/stats');
                const result = await response.json();
                
                if (result.success) {
                    const stats = result.data;
                    document.getElementById('total-photos').textContent = stats.totalPhotos;
                    document.getElementById('revenue-photos').textContent = stats.revenuePhotos;
                    document.getElementById('maintenance-photos').textContent = stats.maintenancePhotos;
                }
            } catch (error) {
                console.error('ËºâÂÖ•ÁÖßÁâáÁµ±Ë®àÂ§±Êïó:', error);
            }
        }
        
        // ËºâÂÖ•ÂàÜÂ∫óÈÅ∏È†Ö
        async function loadPhotoStores() {
            try {
                const response = await fetch('/api/admin/stores');
                const result = await response.json();
                
                if (result.success) {
                    const storeSelect = document.getElementById('photo-store');
                    storeSelect.innerHTML = '<option value="">ÂÖ®ÈÉ®ÂàÜÂ∫ó</option>';
                    
                    result.data.forEach(store => {
                        const option = document.createElement('option');
                        option.value = store.storeId;
                        option.textContent = store.name;
                        storeSelect.appendChild(option);
                    });
                }
            } catch (error) {
                console.error('ËºâÂÖ•ÂàÜÂ∫óÂàóË°®Â§±Êïó:', error);
            }
        }
        
        // ËºâÂÖ•ÁÖßÁâáÂàóË°®
        async function loadPhotos() {
            try {
                const type = document.getElementById('photo-type').value;
                const storeId = document.getElementById('photo-store').value;
                const startDate = document.getElementById('photo-start-date').value;
                const endDate = document.getElementById('photo-end-date').value;
                
                const params = new URLSearchParams({
                    page: currentPhotoPage,
                    limit: photoPageSize
                });
                
                if (type) params.append('type', type);
                if (storeId) params.append('storeId', storeId);
                if (startDate) params.append('startDate', startDate);
                if (endDate) params.append('endDate', endDate);
                
                const response = await fetch(`/api/admin/photos?${params}`);
                const result = await response.json();
                
                if (result.success) {
                    displayPhotos(result.data.photos);
                    updatePhotoPagination(result.data.pagination);
                } else {
                    document.getElementById('photo-grid').innerHTML = `<div class="loading">ËºâÂÖ•Â§±Êïó: ${result.message}</div>`;
                }
            } catch (error) {
                console.error('ËºâÂÖ•ÁÖßÁâáÂ§±Êïó:', error);
                document.getElementById('photo-grid').innerHTML = '<div class="loading">ËºâÂÖ•Â§±Êïó</div>';
            }
        }
        
        // È°ØÁ§∫ÁÖßÁâá
        function displayPhotos(photos) {
            const photoGrid = document.getElementById('photo-grid');
            
            if (photos.length === 0) {
                photoGrid.innerHTML = '<div class="loading">Êö´ÁÑ°ÁÖßÁâá</div>';
                return;
            }
            
            const photosHtml = photos.map(photo => `
                <div class="photo-item">
                    <img src="/uploads/${photo.filename}" 
                         alt="${photo.recordTypeName}ÁÖßÁâá" 
                         class="photo-thumbnail"
                         onclick="viewPhoto('${photo.filename}', '${photo.recordTypeName}')">
                    <div class="photo-info">
                        <span class="photo-type ${photo.recordType}">${photo.recordTypeName}</span>
                        <div><strong>Âì°Â∑•:</strong> ${photo.employeeName}</div>
                        <div><strong>ÂàÜÂ∫ó:</strong> ${photo.storeName}</div>
                        <div><strong>Êó•Êúü:</strong> ${new Date(photo.date).toLocaleDateString('zh-TW')}</div>
                        ${photo.category ? `<div><strong>È°ûÂà•:</strong> ${photo.category}</div>` : ''}
                        ${photo.equipment ? `<div><strong>Ë®≠ÂÇô:</strong> ${photo.equipment}</div>` : ''}
                        <div><strong>‰∏äÂÇ≥ÊôÇÈñì:</strong> ${new Date(photo.uploadTime).toLocaleString('zh-TW')}</div>
                    </div>
                </div>
            `).join('');
            
            photoGrid.innerHTML = photosHtml;
        }
        
        // Êõ¥Êñ∞ÂàÜÈ†ÅÊéßÂà∂
        function updatePhotoPagination(pagination) {
            totalPhotoPages = pagination.totalPages;
            
            document.getElementById('photo-pagination-info').textContent = 
                `Á¨¨ ${pagination.currentPage} È†ÅÔºåÂÖ± ${pagination.totalItems} Á≠Ü`;
            
            document.getElementById('photo-prev-page').disabled = pagination.currentPage <= 1;
            document.getElementById('photo-next-page').disabled = pagination.currentPage >= pagination.totalPages;
        }
        
        // ÊêúÂ∞ãÁÖßÁâá
        function searchPhotos() {
            currentPhotoPage = 1;
            loadPhotos();
        }
        
        // ÈáçÊñ∞Êï¥ÁêÜÁÖßÁâá
        function refreshPhotos() {
            loadPhotoStats();
            loadPhotos();
        }
        
        // Êõ¥ÊîπÁÖßÁâáÈ†ÅÈù¢
        function changePhotoPage(direction) {
            const newPage = currentPhotoPage + direction;
            if (newPage >= 1 && newPage <= totalPhotoPages) {
                currentPhotoPage = newPage;
                loadPhotos();
            }
        }
        
        // Êü•ÁúãÁÖßÁâá
        function viewPhoto(filename, type) {
            // ÂâµÂª∫Ê®°ÊÖãÊ°Ü‰æÜÈ°ØÁ§∫Â§ßÂúñ
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                z-index: 1000;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
            `;
            
            const img = document.createElement('img');
            img.src = `/uploads/${filename}`;
            img.style.cssText = `
                max-width: 90%;
                max-height: 90%;
                border-radius: 10px;
            `;
            
            modal.appendChild(img);
            modal.onclick = () => document.body.removeChild(modal);
            document.body.appendChild(modal);
        }
    </script>
</body>
</html>